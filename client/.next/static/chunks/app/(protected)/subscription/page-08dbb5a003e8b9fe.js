(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[849],{5228:function(e,t,r){Promise.resolve().then(r.bind(r,1778))},1778:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var s=r(7437),a=r(1920),n=r(7029),i=r(2265),l=r(1066);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,l.Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),o=(0,l.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var d=r(4697),u=r(4109),h=r(6935),m=r(4674),x=r(3648),p=()=>{let{supabase:e}=(0,m.$4)(),[t,r]=(0,i.useState)([]),[l,p]=(0,i.useState)(null),[y,b]=(0,i.useState)(!0),[f,g]=(0,i.useState)(""),[j,N]=(0,i.useState)(null),[w,v]=(0,i.useState)("monthly"),_=e=>{try{if(!e)return{};if("object"==typeof e)return e;if("string"==typeof e){let t=JSON.parse(e);return"object"==typeof t?t:{}}return{}}catch(e){return console.error("Feature parse error:",e),{}}};(0,i.useEffect)(()=>{(async()=>{try{let{data:{session:t}}=await e.auth.getSession();if(!(null==t?void 0:t.access_token))throw Error("No active session");let s="http://localhost:5000",[i,l]=await Promise.all([fetch("".concat(s,"/api/subscriptions/plans")),fetch("".concat(s,"/api/subscriptions/current"),{headers:{Authorization:"Bearer ".concat(t.access_token)}})]);if(!i.ok)throw Error("Failed to fetch plans");if(!l.ok)throw Error("Failed to fetch current subscription");let c=await i.json(),o=await l.json(),d=(c||[]).map(e=>(0,n._)((0,a._)({},e),{features:_(e.features)}));r(d),p((null==o?void 0:o.clinic)||null)}catch(e){console.error("Fetch data error:",e),g(e.message)}finally{b(!1)}})()},[e]);let k=async t=>{try{N(t.id),g("");let{data:{session:r}}=await e.auth.getSession();if(!(null==r?void 0:r.access_token))throw Error("No active session");let s=await fetch("".concat("http://localhost:5000","/api/subscriptions/initialize-payment"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r.access_token)},body:JSON.stringify({plan_id:t.id,billing_period:w})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to initialize payment")}let a=await s.json();if(a.authorization_url)window.location.href=a.authorization_url;else throw Error("Payment URL not received")}catch(e){console.error("Payment error:",e),g(e.message),N(null)}};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Subscription Plans"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Choose the plan that best fits your clinic’s needs — prices are in USD"})]}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>v("monthly"),className:"px-4 py-2 rounded-lg border text-sm font-medium ".concat("monthly"===w?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"),children:"Monthly Billing"}),(0,s.jsx)("button",{onClick:()=>v("yearly"),className:"px-4 py-2 rounded-lg border text-sm font-medium ".concat("yearly"===w?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"),children:"Yearly Billing (Save 20%)"})]}),f&&(0,s.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:f}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:y?(0,s.jsx)("div",{className:"md:col-span-4 py-12 text-center",children:(0,s.jsx)(x.Z,{})}):0===t.length?(0,s.jsx)("div",{className:"md:col-span-4 text-center py-12",children:"No plans available"}):t.map(e=>{var t;let r=((null==l?void 0:l.subscription_plan)||"free").toLowerCase()===(null===(t=e.name)||void 0===t?void 0:t.toLowerCase()),a=j===e.id;return(0,s.jsxs)("div",{className:"relative bg-white border rounded-2xl p-6 shadow-sm hover:shadow-md transition ".concat(e.is_popular?"ring-2 ring-blue-500":""," ").concat(r?"bg-blue-50":""),children:[e.is_popular&&(0,s.jsx)("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:(0,s.jsxs)("span",{className:"bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[(0,s.jsx)(c,{className:"h-4 w-4 mr-1"}),"Popular"]})}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.display_name||e.name}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("span",{className:"text-3xl font-bold text-gray-900",children:["$","yearly"===w?e.price_yearly:e.price_monthly]}),(0,s.jsxs)("span",{className:"text-gray-600",children:["/","yearly"===w?"year":"month"]})]}),(0,s.jsx)("ul",{className:"space-y-2 mb-6 text-left",children:Object.keys(e.features).length>0?Object.entries(e.features).map(e=>{let[t,r]=e;return(0,s.jsxs)("li",{className:"flex items-center text-sm text-gray-700",children:[r?(0,s.jsx)(o,{className:"h-4 w-4 text-green-500 mr-2"}):(0,s.jsx)(d.Z,{className:"h-4 w-4 text-red-400 mr-2"}),(0,s.jsxs)("span",{className:"capitalize",children:[t.replace(/_/g," ")," ","number"==typeof r?"(".concat(r,")"):""]})]},t)}):(0,s.jsx)("li",{className:"text-sm text-gray-500 italic",children:"No features listed"})}),(0,s.jsx)("button",{onClick:()=>k(e),disabled:r||a,className:"w-full py-2 px-4 rounded-lg font-medium transition-colors flex items-center justify-center ".concat(r?"bg-gray-200 text-gray-500 cursor-not-allowed":a?"bg-gray-400 text-white cursor-wait":"bg-blue-600 text-white hover:bg-blue-700"),children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):r?"Current Plan":"Upgrade"})]})]},e.id)})}),(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Information"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-4",children:["All plans are billed in ",(0,s.jsx)("b",{children:"USD"}),". Payment is processed securely through Paystack (converted to NGN automatically)."]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,s.jsx)(h.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Secure payment processing"})]})]})]})};function y(){return(0,s.jsx)(p,{})}},1066:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var s=r(1920),a=r(7029),n=r(3090),i=r(2265),l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let r=(0,i.forwardRef)((r,o)=>{var{color:d="currentColor",size:u=24,strokeWidth:h=2,absoluteStrokeWidth:m,className:x="",children:p}=r,y=(0,n._)(r,["color","size","strokeWidth","absoluteStrokeWidth","className","children"]);return(0,i.createElement)("svg",(0,s._)((0,a._)((0,s._)({ref:o},l),{width:u,height:u,stroke:d,strokeWidth:m?24*Number(h)/Number(u):h,className:["lucide","lucide-".concat(c(e)),x].join(" ")}),y),[...t.map(e=>{let[t,r]=e;return(0,i.createElement)(t,r)}),...Array.isArray(p)?p:[p]])});return r.displayName="".concat(e),r}},6935:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},4109:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4697:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3648:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=e=>{let{size:t="md",className:r=""}=e;return(0,s.jsx)("div",{className:"flex items-center justify-center ".concat(r),children:(0,s.jsx)("div",{className:"loading-spinner ".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12",xl:"h-16 w-16"}[t])})})}},4674:function(e,t,r){"use strict";r.d(t,{$4:function(){return u},FV:function(){return h}});var s=r(7437),a=r(2265),n=r(2835);let i="https://phoumeccawrtsjztxldi.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBob3VtZWNjYXdydHNqenR4bGRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzNDEyNTcsImV4cCI6MjA3NTkxNzI1N30.xMGO_scepJgrqhF318DZuXQwuVcZR47AMS81wFwcQA0";i&&i.startsWith("https://"),l&&l.split(".").length;let c=i&&l?(0,n.eI)(i,l):null,o={supabase:c},d=(0,a.createContext)(),u=()=>{let e=(0,a.useContext)(d);if(!e)throw Error("useSupabase must be used within a SupabaseProvider");return e},h=e=>{let{children:t}=e;if(!c){let e=[];i||e.push("NEXT_PUBLIC_SUPABASE_URL"),l||e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY");let t=e=>"string"==typeof e?"".concat(e.slice(0,6),"...").concat(e.slice(-4)):"";return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-lg w-full bg-red-50 border border-red-200 rounded-md p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Configuration error"}),(0,s.jsx)("p",{className:"text-sm text-red-700 mb-3",children:"Missing required environment variables. Update client/.env.local and restart the dev server."}),(0,s.jsxs)("ul",{className:"text-sm text-red-700 list-disc pl-5 space-y-1",children:[!i&&(0,s.jsx)("li",{children:"REACT_APP_SUPABASE_URL is missing"}),!l&&(0,s.jsx)("li",{children:"REACT_APP_SUPABASE_ANON_KEY is missing"})]}),(0,s.jsxs)("div",{className:"mt-4 text-xs text-red-700",children:[(0,s.jsx)("div",{children:"Current values (masked):"}),(0,s.jsxs)("div",{children:["URL: ",i?t(i):"(not set)"]}),(0,s.jsxs)("div",{children:["Anon Key: ",l?t(l):"(not set)"]})]}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload App"})]})})}return(0,s.jsx)(d.Provider,{value:o,children:t})}}},function(e){e.O(0,[835,971,23,744],function(){return e(e.s=5228)}),_N_E=e.O()}]);