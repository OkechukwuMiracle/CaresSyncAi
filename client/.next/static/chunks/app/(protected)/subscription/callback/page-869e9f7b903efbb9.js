(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{6014:function(e,t,r){Promise.resolve().then(r.bind(r,401))},401:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var s=r(7437),n=r(2265),a=r(6463),i=r(4109),c=r(5862);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,r(1066).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var l=r(4674);function u(){let e=(0,a.useRouter)(),t=(0,a.useSearchParams)(),{supabase:r}=(0,l.$4)(),[u,d]=(0,n.useState)("verifying"),[m,h]=(0,n.useState)("Verifying your payment...");return(0,n.useEffect)(()=>{(async()=>{try{let s=t.get("reference");if(!s){d("error"),h("Payment reference not found");return}let{data:{session:n}}=await r.auth.getSession();if(!(null==n?void 0:n.access_token)){d("error"),h("Session expired. Please log in again.");return}let a=await fetch("".concat("http://localhost:5000","/api/subscriptions/verify-payment"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n.access_token)},body:JSON.stringify({reference:s})}),i=await a.json();if(!a.ok){d("error"),h(i.error||"Payment verification failed");return}"success"===i.status?(d("success"),h("Payment successful! Your subscription has been upgraded."),setTimeout(()=>{e.push("/subscription")},3e3)):(d("error"),h("Payment was not successful. Please try again."))}catch(e){console.error("Payment verification error:",e),d("error"),h(e.message||"An error occurred while verifying payment")}})()},[t,r,e]),(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:["verifying"===u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{className:"h-16 w-16 text-primary-500 animate-spin mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verifying Payment"}),(0,s.jsx)("p",{className:"text-gray-600",children:m})]}),"success"===u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Z,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Successful!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:m}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting you back..."})]}),"error"===u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Payment Failed"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:m}),(0,s.jsx)("button",{onClick:()=>e.push("/subscription"),className:"btn-primary w-full",children:"Back to Subscriptions"})]})]})})}},1066:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var s=r(1920),n=r(7029),a=r(3090),i=r(2265),c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),l=(e,t)=>{let r=(0,i.forwardRef)((r,l)=>{var{color:u="currentColor",size:d=24,strokeWidth:m=2,absoluteStrokeWidth:h,className:x="",children:f}=r,p=(0,a._)(r,["color","size","strokeWidth","absoluteStrokeWidth","className","children"]);return(0,i.createElement)("svg",(0,s._)((0,n._)((0,s._)({ref:l},c),{width:d,height:d,stroke:u,strokeWidth:h?24*Number(m)/Number(d):m,className:["lucide","lucide-".concat(o(e)),x].join(" ")}),p),[...t.map(e=>{let[t,r]=e;return(0,i.createElement)(t,r)}),...Array.isArray(f)?f:[f]])});return r.displayName="".concat(e),r}},5862:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},4109:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(1066).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6463:function(e,t,r){"use strict";var s=r(1169);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},4674:function(e,t,r){"use strict";r.d(t,{$4:function(){return d},FV:function(){return m}});var s=r(7437),n=r(2265),a=r(46);let i="https://phoumeccawrtsjztxldi.supabase.co",c="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBob3VtZWNjYXdydHNqenR4bGRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAzNDEyNTcsImV4cCI6MjA3NTkxNzI1N30.xMGO_scepJgrqhF318DZuXQwuVcZR47AMS81wFwcQA0";i&&i.startsWith("https://"),c&&c.split(".").length;let o=i&&c?(0,a.eI)(i,c):null,l={supabase:o},u=(0,n.createContext)(),d=()=>{let e=(0,n.useContext)(u);if(!e)throw Error("useSupabase must be used within a SupabaseProvider");return e},m=e=>{let{children:t}=e;if(!o){let e=[];i||e.push("NEXT_PUBLIC_SUPABASE_URL"),c||e.push("NEXT_PUBLIC_SUPABASE_ANON_KEY");let t=e=>"string"==typeof e?"".concat(e.slice(0,6),"...").concat(e.slice(-4)):"";return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-lg w-full bg-red-50 border border-red-200 rounded-md p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Configuration error"}),(0,s.jsx)("p",{className:"text-sm text-red-700 mb-3",children:"Missing required environment variables. Update client/.env.local and restart the dev server."}),(0,s.jsxs)("ul",{className:"text-sm text-red-700 list-disc pl-5 space-y-1",children:[!i&&(0,s.jsx)("li",{children:"REACT_APP_SUPABASE_URL is missing"}),!c&&(0,s.jsx)("li",{children:"REACT_APP_SUPABASE_ANON_KEY is missing"})]}),(0,s.jsxs)("div",{className:"mt-4 text-xs text-red-700",children:[(0,s.jsx)("div",{children:"Current values (masked):"}),(0,s.jsxs)("div",{children:["URL: ",i?t(i):"(not set)"]}),(0,s.jsxs)("div",{children:["Anon Key: ",c?t(c):"(not set)"]})]}),(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload App"})]})})}return(0,s.jsx)(u.Provider,{value:l,children:t})}}},function(e){e.O(0,[46,971,23,744],function(){return e(e.s=6014)}),_N_E=e.O()}]);