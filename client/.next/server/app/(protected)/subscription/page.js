(()=>{var e={};e.id=849,e.ids=[849],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},7862:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>x,tree:()=>c}),r(5200),r(4896),r(5866),r(4752);var s=r(3191),a=r(8716),n=r(7922),i=r.n(n),o=r(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c=["",{children:["(protected)",{children:["subscription",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5200)),"C:\\Users\\lenovo\\Desktop\\caresync\\client\\app\\(protected)\\subscription\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,4896)),"C:\\Users\\lenovo\\Desktop\\caresync\\client\\app\\(protected)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,4752)),"C:\\Users\\lenovo\\Desktop\\caresync\\client\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\lenovo\\Desktop\\caresync\\client\\app\\(protected)\\subscription\\page.tsx"],p="/(protected)/subscription/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(protected)/subscription/page",pathname:"/subscription",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6876:(e,t,r)=>{Promise.resolve().then(r.bind(r,123))},123:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(326),a=r(7577),n=r(6557);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,n.Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),o=(0,n.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var l=r(4019),c=r(5290),d=r(8916),p=r(8078),u=r(127);let x=()=>{let{supabase:e}=(0,p.$4)(),[t,r]=(0,a.useState)([]),[n,x]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0),[y,g]=(0,a.useState)(""),[b,f]=(0,a.useState)(null),[j,v]=(0,a.useState)("monthly"),w=e=>{try{if(!e)return{};if("object"==typeof e)return e;if("string"==typeof e){let t=JSON.parse(e);return"object"==typeof t?t:{}}return{}}catch(e){return console.error("Feature parse error:",e),{}}};(0,a.useEffect)(()=>{(async()=>{try{let{data:{session:t}}=await e.auth.getSession();if(!t?.access_token)throw Error("No active session");let s="http://localhost:5000",[a,n]=await Promise.all([fetch(`${s}/api/subscriptions/plans`),fetch(`${s}/api/subscriptions/current`,{headers:{Authorization:`Bearer ${t.access_token}`}})]);if(!a.ok)throw Error("Failed to fetch plans");if(!n.ok)throw Error("Failed to fetch current subscription");let i=await a.json(),o=await n.json(),l=(i||[]).map(e=>({...e,features:w(e.features)}));r(l),x(o?.clinic||null)}catch(e){console.error("Fetch data error:",e),g(e.message)}finally{h(!1)}})()},[e]);let N=async t=>{try{f(t.id),g("");let{data:{session:r}}=await e.auth.getSession();if(!r?.access_token)throw Error("No active session");let s=await fetch("http://localhost:5000/api/subscriptions/initialize-payment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.access_token}`},body:JSON.stringify({plan_id:t.id,billing_period:j})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to initialize payment")}let a=await s.json();if(a.authorization_url)window.location.href=a.authorization_url;else throw Error("Payment URL not received")}catch(e){console.error("Payment error:",e),g(e.message),f(null)}};return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subscription Plans"}),s.jsx("p",{className:"text-gray-600",children:"Choose the plan that best fits your clinic’s needs — prices are in USD"})]}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4",children:[s.jsx("button",{onClick:()=>v("monthly"),className:`px-4 py-2 rounded-lg border text-sm font-medium ${"monthly"===j?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"}`,children:"Monthly Billing"}),s.jsx("button",{onClick:()=>v("yearly"),className:`px-4 py-2 rounded-lg border text-sm font-medium ${"yearly"===j?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300"}`,children:"Yearly Billing (Save 20%)"})]}),y&&s.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:y}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:m?s.jsx("div",{className:"md:col-span-4 py-12 text-center",children:s.jsx(u.Z,{})}):0===t.length?s.jsx("div",{className:"md:col-span-4 text-center py-12",children:"No plans available"}):t.map(e=>{let t=(n?.subscription_plan||"free").toLowerCase()===e.name?.toLowerCase(),r=b===e.id;return(0,s.jsxs)("div",{className:`relative bg-white border rounded-2xl p-6 shadow-sm hover:shadow-md transition ${e.is_popular?"ring-2 ring-blue-500":""} ${t?"bg-blue-50":""}`,children:[e.is_popular&&s.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:(0,s.jsxs)("span",{className:"bg-blue-600 text-white px-3 py-1 rounded-full text-sm font-medium flex items-center",children:[s.jsx(i,{className:"h-4 w-4 mr-1"}),"Popular"]})}),(0,s.jsxs)("div",{className:"text-center",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.display_name||e.name}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("span",{className:"text-3xl font-bold text-gray-900",children:["$","yearly"===j?e.price_yearly:e.price_monthly]}),(0,s.jsxs)("span",{className:"text-gray-600",children:["/","yearly"===j?"year":"month"]})]}),s.jsx("ul",{className:"space-y-2 mb-6 text-left",children:Object.keys(e.features).length>0?Object.entries(e.features).map(([e,t])=>(0,s.jsxs)("li",{className:"flex items-center text-sm text-gray-700",children:[t?s.jsx(o,{className:"h-4 w-4 text-green-500 mr-2"}):s.jsx(l.Z,{className:"h-4 w-4 text-red-400 mr-2"}),(0,s.jsxs)("span",{className:"capitalize",children:[e.replace(/_/g," ")," ","number"==typeof t?`(${t})`:""]})]},e)):s.jsx("li",{className:"text-sm text-gray-500 italic",children:"No features listed"})}),s.jsx("button",{onClick:()=>N(e),disabled:t||r,className:`w-full py-2 px-4 rounded-lg font-medium transition-colors flex items-center justify-center ${t?"bg-gray-200 text-gray-500 cursor-not-allowed":r?"bg-gray-400 text-white cursor-wait":"bg-blue-600 text-white hover:bg-blue-700"}`,children:r?(0,s.jsxs)(s.Fragment,{children:[s.jsx(c.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):t?"Current Plan":"Upgrade"})]})]},e.id)})}),(0,s.jsxs)("div",{className:"card",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Information"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-4",children:["All plans are billed in ",s.jsx("b",{children:"USD"}),". Payment is processed securely through Paystack (converted to NGN automatically)."]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[s.jsx(d.Z,{className:"h-4 w-4"}),s.jsx("span",{children:"Secure payment processing"})]})]})]})};function m(){return s.jsx(x,{})}},5290:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,r(6557).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},5200:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>n,default:()=>o});var s=r(8570);let a=(0,s.createProxy)(String.raw`C:\Users\lenovo\Desktop\caresync\client\app\(protected)\subscription\page.tsx`),{__esModule:n,$$typeof:i}=a;a.default;let o=(0,s.createProxy)(String.raw`C:\Users\lenovo\Desktop\caresync\client\app\(protected)\subscription\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[629,599,131],()=>r(7862));module.exports=s})();